<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="shortcut icon" type="image/png" href="../../../img/img.png"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../../static/login/package1.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <title>Maertin Heating & Cooling Bidding Program</title>
</head>
<body style="background: #008B8B;" >
<div class="container1">
    <div class="container1add">
         <div class="butclose">
            <span class="closeadd-btn" onclick="closeFormAndRedirect()">&times;</span>
        </div>
      <form class="form2" method="post"
            package11a-url="{% url 'mhadatabase:package11a' %}"
            package11b-url="{% url 'mhadatabase:package11b' %}"
      >
          {% csrf_token %}
    {{ formset.management_form }}



    <!-- Form for adding a new record -->
    <div id="header2A">
        Add New Material to Package 11
    </div>
          <div class="header1">
          <div class="Aa">Description</div>
          <div class="Ca">Quantity</div>
      </div>
          <div id="newrecord">
              {{ new_form.name_of_field }}
              <div class="rowmat">
                        {{ new_form.description.errors }}
                        {{ new_form.description }}
              </div>
              <div class="rowmat">
                        {{ new_form.quant.errors }}
                        {{ new_form.quant }}
              </div>
          </div>
      </form>
        <div id="butrowA" style="display:none">
        <a href="{% url 'mhadatabase:packagepage3' %}">
                  <button type="button" class="button2A">Accept</button>
              </a>
        </div>
    </div>
</div>
</body>
</html>
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

<script>


$(function(){
   $('#id_description').change(function(){
        setTimeout(function(){
                var selectBox =document.getElementById('id_description');
                var userInput =selectBox.options[selectBox.selectedIndex].value;
                console.log(userInput);
                var url = $(".form2").attr("package11a-url");
                    $.ajax({
                        type:'POST',
                       url: url,
                       data:{
                            id_description: $('#id_description').val(),
                            csrfmiddlewaretoken: '{{ csrf_token }}'
                         },
                    });
        }, 0);
    });
});

$(function(){
   $('#id_quant').change(function(){
       $("#butrowA").show()
        setTimeout(function(){
                var selectBox =document.getElementById('id_quant');
                var userInput =selectBox.options[selectBox.selectedIndex].value;
                console.log(userInput);
                var url = $(".form2").attr("package11b-url");
                    $.ajax({
                        type:'POST',
                       url: url,
                       data:{
                            id_quant: $('#id_quant').val(),
                            csrfmiddlewaretoken: '{{ csrf_token }}'
                         },
                    });
        }, 300);
    });
});

function closeFormAndRedirect() {
    window.location.href = '{% url 'mhadatabase:packagepage3' %}'; // Redirect
}


</script>